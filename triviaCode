Option Explicit

Dim easyBegin As Integer, easyEnd As Integer, mediumBegin As Integer, mediumEnd As Integer, hardBegin As Integer, hardEnd As Integer, lotteryBegin As Integer, lotteryEnd As Integer
Dim birdsOne As Integer, birdsTwo As Integer, birdsThree As Integer, pigsOne As Integer, pigsTwo As Integer, pigsThree As Integer
Dim gameboard As Integer, lottery As Integer, chosenSlide As Integer
Dim chosenShape As String

Dim slideNumbers() As Long
Dim lotteryNumbers() As Long
Dim alreadyShownTrivia() As Boolean
Dim alreadyShownLottery() As Boolean

Private Sub GetCurrentSlideID()
    Dim currentSlideID As String
    currentSlideID = ActiveWindow.View.Slide.SlideID
    MsgBox "The ID of the current slide is: " & currentSlideID
End Sub

Sub GetTextboxWidth()
Dim shp As Shape
Set shp = ActiveWindow.Selection.ShapeRange(1)

If shp.Type = msoTextBox Then
    Debug.Print shp.Width
    Debug.Print shp.Height
End If
End Sub

Sub StartGame()
    'Set the current slide numbers for the gameboard and points slides
    FindGameboardAndPointsSlides
    
    'Go through all slides and delete any QuestionID textboxes remaining from previous games
    DeleteQuestionIDs
    
    'Reset the scoreboard
    ResetScoreboard
    
    'Create arrays to keep track of which questions and lottery events have already been shown this game
    CreateSlidesArrays
    
End Sub

Private Sub FindGameboardAndPointsSlides()
    Dim sld As Slide
    
    For Each sld In ActivePresentation.Slides
        If sld.SlideID = 259 Then
            gameboard = sld.slideIndex
        ElseIf sld.SlideID = 260 Then
            birdsOne = sld.slideIndex
        ElseIf sld.SlideID = 262 Then
            birdsTwo = sld.slideIndex
        ElseIf sld.SlideID = 264 Then
            birdsThree = sld.slideIndex
        ElseIf sld.SlideID = 266 Then
            pigsOne = sld.slideIndex
        ElseIf sld.SlideID = 268 Then
            pigsTwo = sld.slideIndex
        ElseIf sld.SlideID = 270 Then
            pigsThree = sld.slideIndex
        ElseIf sld.SlideID = 272 Then
            lottery = sld.slideIndex
        End If
    Next sld
End Sub

Private Sub DeleteQuestionIDs()
    Dim sld As Slide, shp As Shape
    
    For Each sld In ActivePresentation.Slides ' Loop through all slides
        For Each shp In sld.Shapes ' Loop through all shapes on the slide
            If shp.Name = "QuestionID" Then ' Check if shape name is "QuestionID"
                shp.Delete ' Delete the shape
            End If
        Next shp
    Next sld
End Sub

Private Sub ResetScoreboard()
    ActivePresentation.Slides(gameboard).Shapes("Birds_Scoreboard").TextFrame.TextRange.Text = 0
    ActivePresentation.Slides(gameboard).Shapes("Pigs_Scoreboard").TextFrame.TextRange.Text = 0
End Sub

Private Sub CreateSlidesArrays()
    Dim sld As Slide, secIndex As Long, secStart() As Long, secEnd() As Long
    ReDim secStart(1 To ActivePresentation.SectionProperties.Count)
    ReDim secEnd(1 To ActivePresentation.SectionProperties.Count)

    For Each sld In ActivePresentation.Slides
        secIndex = sld.sectionIndex
        If secStart(secIndex) = 0 Or sld.slideIndex < secStart(secIndex) Then
            secStart(secIndex) = sld.slideIndex
        End If
        If sld.slideIndex > secEnd(secIndex) Then
            secEnd(secIndex) = sld.slideIndex
        End If
    Next sld

    Dim i As Long

    For i = 1 To ActivePresentation.SectionProperties.Count
        If ActivePresentation.SectionProperties.Name(i) = "Easy Questions" Then
            easyBegin = secStart(i)
            easyEnd = secEnd(i)
        ElseIf ActivePresentation.SectionProperties.Name(i) = "Medium Questions" Then
            mediumBegin = secStart(i)
            mediumEnd = secEnd(i)
        ElseIf ActivePresentation.SectionProperties.Name(i) = "Hard Questions" Then
            hardBegin = secStart(i)
            hardEnd = secEnd(i)
        ElseIf ActivePresentation.SectionProperties.Name(i) = "Lottery Events" Then
            lotteryBegin = secStart(i)
            lotteryEnd = secEnd(i)
        End If
    Next i
    
    ' Loop through each slide and store slide numbers for slides in Easy Questions, Medium Questions, and Hard Questions sections in slideNumbers
    ' and store the slide numbers for the slides in Lottery Events in lotteryNumbers
    ReDim slideNumbers(1 To ActivePresentation.Slides.Count)
    ReDim lotteryNumbers(1 To ActivePresentation.Slides.Count)
    ReDim alreadyShownTrivia(1 To ActivePresentation.Slides.Count)
    ReDim alreadyShownLottery(1 To ActivePresentation.Slides.Count)
    Dim j As Integer
    For j = 1 To ActivePresentation.Slides.Count
        If j >= easyBegin And j <= easyEnd Or j >= mediumBegin And j <= mediumEnd Or j >= hardBegin And j <= hardEnd Then
            slideNumbers(j) = j
            alreadyShownTrivia(j) = False
        ElseIf j >= lotteryBegin And j <= lotteryEnd Then
            lotteryNumbers(j) = j
            alreadyShownTrivia(j) = False
        End If
    Next j

End Sub

Sub ToLottery()
    SlideShowWindows(1).View.GotoSlide (lottery)
End Sub

Sub ToEvent()
    Dim chosenSlide As Integer, sld As Slide
    
    Do
        chosenSlide = RandBetween(lotteryBegin, lotteryEnd)
    Loop While alreadyShownLottery(chosenSlide)
    
    alreadyShownLottery(chosenSlide) = True
    
    SlideShowWindows(1).View.GotoSlide (chosenSlide)
End Sub

Function RandBetween(vLow As Integer, vHigh As Integer)
    Randomize
    RandBetween = Int(vLow + (vHigh - vLow + 1) * Rnd())
End Function

Sub Easy(clickedShp As Shape)
    'Declare variable and initialize the values of the first and final question for this difficulty
    Dim chosenSlide As Integer, sld As Slide
    
    ' Pick a random slide until we find one that has not been shown yet
    Do
        chosenSlide = RandBetween(easyBegin, easyEnd) 'Randomly choose a slide between the given values
    Loop While alreadyShownTrivia(chosenSlide) 'If this is logically true, then it will loop until false
    
    alreadyShownTrivia(chosenSlide) = True 'Set this slide as chosen so that it doesn't appear again
    
    Set sld = ActivePresentation.Slides(chosenSlide)
    
    Dim sldWidth As Integer
    sldWidth = sld.Master.Width
    Dim tbWidth As Integer
    tbWidth = 105
    Dim tbLeft As Integer
    tbLeft = sldWidth - (tbWidth)
    
    chosenShape = clickedShp.Name
    
    SlideShowWindows(1).View.GotoSlide (chosenSlide)
    With sld.Shapes.AddTextbox(msoOrientationHorizontal, tbLeft, 0, 105, 124)
        .Name = "QuestionID"
        .TextFrame.TextRange.Text = clickedShp.Name 'Copy the text from the clicked-on shape into the slide
        .TextFrame.TextRange.Font.Name = "Feast of Flesh BB" 'Font name
        .TextFrame.TextRange.Font.Size = 96 'Font size
        .TextFrame.TextRange.Font.Color.RGB = RGB(0, 0, 0) 'Font color
        .TextFrame.TextRange.Font.Bold = msoTrue
        .TextFrame.TextRange.Font.Italic = msoTrue
        .TextFrame.TextRange.Paragraphs.ParagraphFormat.Alignment = ppAlignCenter 'Align text in the center
    End With
End Sub

Sub Medium(clickedShp As Shape)
    'Declare variable and initialize the values of the first and final question for this difficulty
    Dim chosenSlide As Integer, sld As Slide
    
    ' Pick a random slide until we find one that has not been shown yet
    Do
        chosenSlide = RandBetween(mediumBegin, mediumEnd) 'Randomly choose a slide between the given values
    Loop While alreadyShownTrivia(chosenSlide) 'If this is logically true, then it will loop until false
    
    alreadyShownTrivia(chosenSlide) = True 'Set this slide as chosen so that it doesn't appear again
    
    Set sld = ActivePresentation.Slides(chosenSlide)
    
    Dim sldWidth As Integer
    sldWidth = sld.Master.Width
    Dim tbWidth As Integer
    tbWidth = 105
    Dim tbLeft As Integer
    tbLeft = sldWidth - (tbWidth)
    
    SlideShowWindows(1).View.GotoSlide (chosenSlide)
    With sld.Shapes.AddTextbox(msoOrientationHorizontal, tbLeft, 0, 105, 124)
        .Name = "QuestionID"
        .TextFrame.TextRange.Text = clickedShp.Name 'Copy the text from the clicked-on shape into the slide
        .TextFrame.TextRange.Font.Name = "Feast of Flesh BB" 'Font name
        .TextFrame.TextRange.Font.Size = 96 'Font size
        .TextFrame.TextRange.Font.Color.RGB = RGB(0, 0, 0) 'Font color
        .TextFrame.TextRange.Font.Bold = msoTrue
        .TextFrame.TextRange.Font.Italic = msoTrue
        .TextFrame.TextRange.Paragraphs.ParagraphFormat.Alignment = ppAlignCenter 'Align text in the center
    End With
End Sub

Sub Hard(clickedShp As Shape)
    'Declare variable and initialize the values of the first and final question for this difficulty
    Dim chosenSlide As Integer, sld As Slide
    
    ' Pick a random slide until we find one that has not been shown yet
    Do
        chosenSlide = RandBetween(hardBegin, hardEnd) 'Randomly choose a slide between the given values
    Loop While alreadyShownTrivia(chosenSlide) 'If this is logically true, then it will loop until false
    
    alreadyShownTrivia(chosenSlide) = True 'Set this slide as chosen so that it doesn't appear again
    
    Set sld = ActivePresentation.Slides(chosenSlide)
    
    Dim sldWidth As Integer
    sldWidth = sld.Master.Width
    Dim tbWidth As Integer
    tbWidth = 105
    Dim tbLeft As Integer
    tbLeft = sldWidth - (tbWidth)
    
    SlideShowWindows(1).View.GotoSlide (chosenSlide)
    With sld.Shapes.AddTextbox(msoOrientationHorizontal, tbLeft, 0, 105, 124)
        .Name = "QuestionID"
        .TextFrame.TextRange.Text = clickedShp.Name 'Copy the text from the clicked-on shape into the slide
        .TextFrame.TextRange.Font.Name = "Feast of Flesh BB" 'Font name
        .TextFrame.TextRange.Font.Size = 96 'Font size
        .TextFrame.TextRange.Font.Color.RGB = RGB(0, 0, 0) 'Font color
        .TextFrame.TextRange.Font.Bold = msoTrue
        .TextFrame.TextRange.Font.Italic = msoTrue
        .TextFrame.TextRange.Paragraphs.ParagraphFormat.Alignment = ppAlignCenter 'Align text in the center
    End With
End Sub

Sub EasyAndMedium(clickedShp As Shape)
    'Declare variable and initialize the values of the first and final question for this difficulty
    Dim chosenSlide As Integer, sld As Slide
    
    ' Pick a random slide until we find one that has not been shown yet
    Do
        chosenSlide = RandBetween(easyBegin, mediumEnd) 'Randomly choose a slide between the given values
    Loop While alreadyShownTrivia(chosenSlide) 'If this is logically true, then it will loop until false
    
    alreadyShownTrivia(chosenSlide) = True 'Set this slide as chosen so that it doesn't appear again
    
    Set sld = ActivePresentation.Slides(chosenSlide)
    
    Dim sldWidth As Integer
    sldWidth = sld.Master.Width
    Dim tbWidth As Integer
    tbWidth = 105
    Dim tbLeft As Integer
    tbLeft = sldWidth - (tbWidth)
    
    SlideShowWindows(1).View.GotoSlide (chosenSlide)
    With sld.Shapes.AddTextbox(msoOrientationHorizontal, tbLeft, 0, 105, 124)
        .Name = "QuestionID"
        .TextFrame.TextRange.Text = clickedShp.Name 'Copy the text from the clicked-on shape into the slide
        .TextFrame.TextRange.Font.Name = "Feast of Flesh BB" 'Font name
        .TextFrame.TextRange.Font.Size = 96 'Font size
        .TextFrame.TextRange.Font.Color.RGB = RGB(0, 0, 0) 'Font color
        .TextFrame.TextRange.Font.Bold = msoTrue
        .TextFrame.TextRange.Font.Italic = msoTrue
        .TextFrame.TextRange.Paragraphs.ParagraphFormat.Alignment = ppAlignCenter 'Align text in the center
    End With
End Sub

Sub MediumAndHard(clickedShp As Shape)
    'Declare variable and initialize the values of the first and final question for this difficulty
    Dim chosenSlide As Integer, sld As Slide
    
    ' Pick a random slide until we find one that has not been shown yet
    Do
        chosenSlide = RandBetween(mediumBegin, hardEnd) 'Randomly choose a slide between the given values
    Loop While alreadyShownTrivia(chosenSlide) 'If this is logically true, then it will loop until false
    
    alreadyShownTrivia(chosenSlide) = True 'Set this slide as chosen so that it doesn't appear again
    
    Set sld = ActivePresentation.Slides(chosenSlide)
    
    Dim sldWidth As Integer
    sldWidth = sld.Master.Width
    Dim tbWidth As Integer
    tbWidth = 105
    Dim tbLeft As Integer
    tbLeft = sldWidth - (tbWidth)
    
    SlideShowWindows(1).View.GotoSlide (chosenSlide)
    With sld.Shapes.AddTextbox(msoOrientationHorizontal, tbLeft, 0, 105, 124)
        .Name = "QuestionID"
        .TextFrame.TextRange.Text = clickedShp.Name 'Copy the text from the clicked-on shape into the slide
        .TextFrame.TextRange.Font.Name = "Feast of Flesh BB" 'Font name
        .TextFrame.TextRange.Font.Size = 96 'Font size
        .TextFrame.TextRange.Font.Color.RGB = RGB(0, 0, 0) 'Font color
        .TextFrame.TextRange.Font.Bold = msoTrue
        .TextFrame.TextRange.Font.Italic = msoTrue
        .TextFrame.TextRange.Paragraphs.ParagraphFormat.Alignment = ppAlignCenter 'Align text in the center
    End With
End Sub

Sub All(clickedShp As Shape)
    'Declare variable and initialize the values of the first and final question for this difficulty
    Dim chosenSlide As Integer, sld As Slide
    
    ' Pick a random slide until we find one that has not been shown yet
    Do
        chosenSlide = RandBetween(easyBegin, hardEnd) 'Randomly choose a slide between the given values
    Loop While alreadyShownTrivia(chosenSlide) 'If this is logically true, then it will loop until false
    
    alreadyShownTrivia(chosenSlide) = True 'Set this slide as chosen so that it doesn't appear again
    
    Set sld = ActivePresentation.Slides(chosenSlide)
    
    Dim sldWidth As Integer
    sldWidth = sld.Master.Width
    Dim tbWidth As Integer
    tbWidth = 105
    Dim tbLeft As Integer
    tbLeft = sldWidth - (tbWidth)
    
    SlideShowWindows(1).View.GotoSlide (chosenSlide)
    With sld.Shapes.AddTextbox(msoOrientationHorizontal, tbLeft, 0, 105, 124)
        .Name = "QuestionID"
        .TextFrame.TextRange.Text = clickedShp.Name 'Copy the text from the clicked-on shape into the slide
        .TextFrame.TextRange.Font.Name = "Feast of Flesh BB" 'Font name
        .TextFrame.TextRange.Font.Size = 96 'Font size
        .TextFrame.TextRange.Font.Color.RGB = RGB(0, 0, 0) 'Font color
        .TextFrame.TextRange.Font.Bold = msoTrue
        .TextFrame.TextRange.Font.Italic = msoTrue
        .TextFrame.TextRange.Paragraphs.ParagraphFormat.Alignment = ppAlignCenter 'Align text in the center
    End With
End Sub

Sub ReturnToGameboard()
    Dim shp As Shape, sld As Slide, currentSlide As Integer
    Set sld = SlideShowWindows(1).View.Slide
    For Each shp In sld.Shapes
        If shp.Name = "QuestionID" Then
            shp.Delete
            Exit For
        End If
    Next shp
    
    SlideShowWindows(1).View.GotoSlide (gameboard)

End Sub

Sub AwardPigs()
    If ActivePresentation.SlideShowWindow.View.Slide.SlideNumber >= easyBegin And ActivePresentation.SlideShowWindow.View.Slide.SlideNumber <= easyEnd Then
        ActivePresentation.SlideShowWindow.View.GotoSlide (pigsOne)
    ElseIf ActivePresentation.SlideShowWindow.View.Slide.SlideNumber >= mediumBegin And ActivePresentation.SlideShowWindow.View.Slide.SlideNumber <= mediumEnd Then
        ActivePresentation.SlideShowWindow.View.GotoSlide (pigsTwo)
    ElseIf ActivePresentation.SlideShowWindow.View.Slide.SlideNumber >= hardBegin And ActivePresentation.SlideShowWindow.View.Slide.SlideNumber <= hardEnd Then
        ActivePresentation.SlideShowWindow.View.GotoSlide (pigsThree)
    End If
End Sub

Sub AwardBirds()
    If ActivePresentation.SlideShowWindow.View.Slide.SlideNumber >= easyBegin And ActivePresentation.SlideShowWindow.View.Slide.SlideNumber <= easyEnd Then
        ActivePresentation.SlideShowWindow.View.GotoSlide (birdsOne)
    ElseIf ActivePresentation.SlideShowWindow.View.Slide.SlideNumber >= mediumBegin And ActivePresentation.SlideShowWindow.View.Slide.SlideNumber <= mediumEnd Then
        ActivePresentation.SlideShowWindow.View.GotoSlide (birdsTwo)
    ElseIf ActivePresentation.SlideShowWindow.View.Slide.SlideNumber >= hardBegin And ActivePresentation.SlideShowWindow.View.Slide.SlideNumber <= hardEnd Then
        ActivePresentation.SlideShowWindow.View.GotoSlide (birdsThree)
    End If
End Sub
